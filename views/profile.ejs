<%- include("menu") -%>

<link rel="stylesheet" href="/stylesheets/profile.css">
    <div class="col-6 p-2">
        <div class="inner-main">

            <div class="card" id="card">
                
                




            </div>


            <div class="card text-dark bg-white mb-3 mt-2" id="post">
                

            </div>

        </div>
        <form action="/updateProfile" method="post" enctype="multipart/form-data">
            <div class="modal fade ms-2" id="edit_profile" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                
            </div>
        </form>

        <form action="/changePassword" method="post">
            <div class="modal fade" id="change_password" tabindex="-1" aria-labelledby="exampleModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Change Password</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="mb-3">
                                <label for="name" class="form-label">Old Password</label>
                                <input type="name" class="form-control" id="old_password" aria-describedby="emailHelp"
                                    name="old_password">
                                <div id="text" class="form-text"></div>
                            </div>
                            <div class="mb-3">
                                <label for="username" class="form-label">New Paaasword</label>
                                <input type="text" class="form-control" id="new_password" name="new_password">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <input type="submit" class="btn btn-primary" value="Submit">
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <script>


        getuser();

        async function getuser(){
            let data1= await fetch("http://localhost:3008/users");
            let data =await data1.json();
            // Converting received data to JSON
            console.log("data::::",data);

            let usr_details = ``;


            data.forEach(user=>{
            usr_details+= `<div class="modal-dialog">
                    <div class="modal-content border-dark">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Edit Profile</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        
                        <div class="modal-body">
                            <div id="edit_image-section">
                                <div class="cover d-flex border-dark">
                                    <img src="${user.cover_image}" alt="" id="img_prof">
                                    <label for="update_cover_image" class="edit_cover mt-5 " >
                                        <i class="fa-solid fa-2x fa-camera  rounded-circle text-light"
                                            id="edit_camera_icons">
                                        </i>
                                    </label>
                                    <input type="file" name="cover_image" id="update_cover_image" style="display: none;">
                                </div>
                                <div class="row ">
                                    <div class="col">
                                        <div class="dp d-flex">
                                            <img src="${user.user_image}" class="card-img-left" alt="">
                                            <label for="update_profile_image" class="edit_icon mt-5">
                                                <i class="fa-solid fa-camera  rounded-circle text-light "
                                                    id="edit_camera_icons">
                                                </i>
                                            </label>
                                            
                                            <input type="file" name="profile_image" id="update_profile_image" style="display: none;">
                                            
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                            <div id="edit_content">
    
                                <div class="mb-3">
                                    <label for="name" class="form-label">Name</label>
                                    <input type="text" name="name" class="form-control" id="name" aria-describedby="emailHelp"
                                        name="name" value="${user.name}">
                                    <div id="text" class="form-text"></div>
                                </div>
                                <div class="mb-3">
                                    <label for="username" class="form-label">User Email</label>
                                    <input type="text" class="form-control" id="username" name="user_email"
                                    value="${user.email}" readonly>
                                </div>
                                <div class="mb-3">
                                    <label for="bio" class="form-label">Bio</label>
                                    <input type="text" class="form-control" id="bio" name="user_bio"
                                    value="${user.bio}">
                                </div>
                                <div class="mb-3">
                                    <label for="birth_date" class="form-label"></label>
                                    <label for="birth_date" class="form-label">Date Of Birth</label>
                                    <input type="date" class="form-control" id="biobirth_date" name="user_dob"
                                    value="${user.birth_date.slice(0,10)}" readonly>
                                </div>
                            </div>
                        </div>
                        
                    <div class="modal-footer">
                        <input type="submit" class="btn btn-primary" value="Update">
                    </div>
                </div>
            </div>
                `;

                document.getElementById("edit_profile").innerHTML = usr_details;    
        })
        }












tweets();

async function tweets(){
    let data1= await fetch("http://localhost:3008/tweets");
   let data =await data1.json();
   // Converting received data to JSON
   console.log("data::::",data);

    let post = ``;
   

    data.forEach(tweets=>{
        post +=`
        <div class="card-header">
                    <div class="row">
                        <div class="col">
                            <div class="d-flex">
                                <div class="comp-logo">
                                    <img src="${tweets.dp}" alt="">
                                </div>
                                <p class="bold ms-3">${tweets.nm}</p>
                                <p class="text-secondary ms-3">@${tweets.unm}</p>
                                <p class="text-secondary ms-2">Posted</p>
                            </div>
                            <h6 class="card-title mt-1">${tweets.t}</h6>
                        </div>
                    </div>
                </div>
                <div class="card-body">

                    <div class="post-type ms-2 ">
                        <img src="${tweets.p}" class="img-fluid " alt="">
                    </div>

                    <div class="activity d-flex mt-4 ms-5">
                        <p class="text-secondary"><i class="fa-solid fa-heart text-danger"></i> ${tweets.l}</p>

                        <p class="text-secondary ms-5"><i class="fa-solid fa-retweet"></i> ${tweets.r}</p>

                        <p class="text-secondary ms-5"><i class="fa-regular fa-comment"></i> ${tweets.c}</p>
                    </div>
                </div>
        
        `;
    });
    document.getElementById("post").innerHTML = post;
}




demo();
async function demo(){
    let data1= await fetch("http://localhost:3008/profile");
   let data =await data1.json();
   // Converting received data to JSON
   console.log("data::::",data);


    let udata = ``;

    data.forEach(users => {
        udata += `<div class="cover">
                    <img src="${users.cover_image}" alt="">
                </div>
                <div class="row ">
                    <div class="col">
                        <div class="dp">
                            <img src="${users.user_image}" class="card-img-left" alt="">
                        </div>
                    </div>
                    <div class="col">
                        <div class="mt-2 ms-5 follow">
                            <p>
                                <a href="" class="menu-link rounded-pill px-3" data-bs-toggle="modal" data-bs-target="#settingsModal"
                                onclick="e.preventDefault()">
                                Edit Profile
                                
                                </a>
                                </p>
                        </div>
                    </div>

                </div>
                <div class="card-body">
                    <div class="user-data">
                        
                        <label for="" class="bold">${users.name}</label>
                        <img src="./uploads/verified.jpg" alt="" height="20px" width="20px">
                        
                        <p class="text-secondary">@${users.user_name}</p>
                    </div>
                    <p class="card-text text-dark ">${users.bio}  <i class="fa-regular fa-face-laugh-beam"></i></p>


                    <div class="info d-flex ">
                        <p class="text-secondary ms-1"><i class="fa-solid fa-location-dot"></i> everywhere</p>

                        <p class="text-secondary ms-2"><i class="fa-solid fa-link"></i>
                        <p class="text-info">username.com</p>
                        </p>

                        <p class="text-secondary ms-2"><i class="fa-solid fa-cake-candles"></i> Date Of Birth:  ${users.birth_date.slice(0,10)}
                        </p>
                    </div>
                    <div class="join">
                        <p class="text-secondary"><i class="fa-solid fa-calendar-days"></i>   ${users.created_at.slice(0,10)}</p>
                    </div>

                    <div class="d-flex">
                        <p>
                            ${users.following}
                        <p class="ms-2">Following</p>

                        </p>
                        <p class="ms-3">
                            ${users.followers}
                        <p class="ms-2">Followers</p>

                        </p>
                    </div>

                </div>
                `;
    });
    
    document.getElementById("card").innerHTML = udata;

}
    </script>

    <%- include("search") -%>